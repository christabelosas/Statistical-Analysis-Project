setwd("~/ASDV")
# Install all required Packages and call all required Libraries
install.packages("car")
install.packages("corrplot")
install.packages("caret")
install.packages("datarium")
install.packages("qqplotr")
install.packages("RVAideMemoire")
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("moments")
install.packages("TTR")
install.packages("forecast")
install.packages("Hmisc")
library("moments")
library("datarium")
library("qqplotr")
library("RVAideMemoire")
library("car")
library("corrplot")
library("tidyverse")
library("car")
library("caret")
library("TTR")
library("forecast")
library("Hmisc")
# Read in the data set file into R
Stat_Data<- read.csv(file = 'Statistical Data Extract.csv')
setwd("~/ASDV/Course Work")
Stat_Data<- read.csv(file = 'Statistical Data Extract.csv')
setwd("~\ASDV")
setwd("~/ASDV/Course Work")
setwd("~/ASDV/Course Work")
setwd("~/ASDV")
Stat_Data<- read.csv(file = 'Statistical Data Extract.csv')
Stat_Data<- read.csv(file = "Statistical Data Extract.csv")
Stat_Data<- read.csv("C:\Users\chris\OneDrive\Documents\ASDV\Course Work\Statistical  Data Extract.csv")
Stat_Data<- read.csv("C:/Users/chris/OneDrive/Documents/ASDV/Course Work/Statistical  Data Extract.csv")
Head(Statistical Data Extract)
Head(Stat_Data)
head(Stat_Data)
names(Stat_Data)
Stat_Data <- data.frame("Country.Name"] "Country.Code", "Time", "Time.Code","Foreign.direct.investment..net.outflows....of.GDP...BM.KLT.DINV.WD.GD.ZS.", "Foreign.direct.investment..net.inflows....of.GDP...BX.KLT.DINV.WD.GD.ZS.","GDP.per.capita.growth..annual.....NY.GDP.PCAP.KD.ZG.","Inflation..consumer.prices..annual.....FP.CPI.TOTL.ZG.","Gross.savings....of.GNI...NY.GNS.ICTR.GN.ZS.","Imports.of.goods.and.services....of.GDP...NE.IMP.GNFS.ZS.","Exports.of.goods.and.services....of.GDP...NE.EXP.GNFS.ZS.","Individuals.using.the.Internet....of.population...IT.NET.USER.ZS.","Fertility.rate..total..births.per.woman...SP.DYN.TFRT.IN.","Mortality.rate..under.5..per.1.000.live.births...SH.DYN.MORT.","Population.ages.15.64....of.total.population...SP.POP.1564.TO.ZS.","Wages"
Stat_Data <- data.frame("Country.Name", "Country.Code", "Time", "Time.Code","Foreign.direct.investment..net.outflows....of.GDP...BM.KLT.DINV.WD.GD.ZS.", "Foreign.direct.investment..net.inflows....of.GDP...BX.KLT.DINV.WD.GD.ZS.","GDP.per.capita.growth..annual.....NY.GDP.PCAP.KD.ZG.","Inflation..consumer.prices..annual.....FP.CPI.TOTL.ZG.","Gross.savings....of.GNI...NY.GNS.ICTR.GN.ZS.","Imports.of.goods.and.services....of.GDP...NE.IMP.GNFS.ZS.","Exports.of.goods.and.services....of.GDP...NE.EXP.GNFS.ZS.","Individuals.using.the.Internet....of.population...IT.NET.USER.ZS.","Fertility.rate..total..births.per.woman...SP.DYN.TFRT.IN.","Mortality.rate..under.5..per.1.000.live.births...SH.DYN.MORT.","Population.ages.15.64....of.total.population...SP.POP.1564.TO.ZS.","Wages")
New_Stat_data<-c("Country","Country Code","Time,"Time Code","FDI Net Outflows (% of GDP)","FDI Net Inflows (% of GDP)","GDP per Capita Growth (annual %)","Inflation (annual %)","Gross Savings (% of GNI)","Imports (% of GDP)","Exports (% of GDP)","Internet Users (% of population)", "Fertility Rate (births per woman)","Under-5 Mortality Rate (per 1,000 live births)", "Population Ages 15-64 (% of total population)", "Wage)
#Install all required Packages and call all required Libraries
install.packages("car")
install.packages("corrplot")
install.packages("caret")
install.packages("datarium")
install.packages("qqplotr")
install.packages("RVAideMemoire")
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("moments")
install.packages("TTR")
install.packages("forecast")
install.packages("Hmisc")
library("moments")
library("datarium")
library("qqplotr")
library("RVAideMemoire")
library("car")
library("corrplot")
library("tidyverse")
library("dplyr")
library("car")
library("caret")
library("TTR")
library("forecast")
library("Hmisc")
# Read in the data set file into R
Stat_Data<- read.csv(file = 'Dataset for Analysis.csv')
#Install all required Packages and call all required Libraries
install.packages("car")
install.packages("corrplot")
install.packages("caret")
install.packages("datarium")
install.packages("qqplotr")
install.packages("RVAideMemoire")
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("moments")
install.packages("TTR")
install.packages("forecast")
install.packages("Hmisc")
library("moments")
library("datarium")
library("qqplotr")
library("RVAideMemoire")
library("car")
library("corrplot")
library("tidyverse")
library("dplyr")
library("car")
library("caret")
library("TTR")
library("forecast")
library("Hmisc")
# Read in the data set file into R
Stat_Data<- read.csv(file = 'Dataset for Analysis.csv')
setwd("C:/Users/chris/OneDrive/Documents/ASDV/Course Work")
# Read in the data set file into R
Stat_Data<- read.csv(file = 'Dataset for Analysis.csv')
head(Stat_Data)
#view the names of the column
names(Stat_Data)
#replace the names of the column to a shortened name to make the dataset easier to view
names(Stat_Data)<-c("Country",
"Year",
"FDI",
"GDP",
"Gdp per Capital",
"GNE",
"Gross Savings",
"Industry(%annual growth)",
"Internet",
"Trade(GDP)",
"Trade in service",
"Agriculture",
"Household Spending",
"Industry(%GDP)")
#view the first and last few lines of the dataset
head(Stat_Data)
tail(Stat_Data)
# check for null values in the file using is.na() function
is.na(Stat_Data) # no null values detected
# check for data types of table columns
str(Stat_Data)
# Run a summary for our data set table for general description of values in each column
summary(Stat_Data)
# Normalize the data into 2 tables containing the two continents Asia and Africa
# Create a new data frame for Asia  Data only
Asia_dataset<- Stat_Data[1:50,]
# Create a new data frame for African  Data only
African_data<- Stat_Data[51:100,]
#view the first and last few lines of the newly created dataframe
head(African_data)
head(Asia_dataset)
#-------------------------------Task 4.1----------------------------------------------
# Descriptive statistical analysis of Asia Data variables
summary(Asia_dataset)
# Describe FDI variable for Asia data
mean(Asia_dataset$FDI)
median(Asia_dataset$FDI)
sd(Asia_dataset$FDI)
var(Asia_dataset$FDI)
skewness(Asia_dataset$FDI)#positively skewed to the right
kurtosis(Asia_dataset$FDI)# distribution is leptokurtic since kurtosis is greater than 3, hence the peak of the distribution is higher than a normal distribution
plot(Asia_dataset$FDI)
hist(Asia_dataset$FDI)# not normally distributed
# Describe GDP variable for Asia data
mean(Asia_dataset$GDP)
median(Asia_dataset$GDP)
sd(Asia_dataset$GDP)
var(Asia_dataset$GDP)
skewness(Asia_dataset$GDP)# Slightly positively skewed to the right, its close to being symmentrical
kurtosis(Asia_dataset$GDP)# distribution is leptokurtic since kurtosis is greater than 3, hence the peak of the distribution is more heavy tailed than  normal distribution
plot(Asia_dataset$GDP)
hist(Asia_dataset$GDP)
# Describe Gross Savings variable for Asia data
mean(Asia_dataset$`Gross Savings`)
median(Asia_dataset$`Gross Savings`)
sd(Asia_dataset$`Gross Savings`)
var(Asia_dataset$`Gross Savings`)
skewness(Asia_dataset$`Gross Savings`)#Slightly positively skewed to the right and close to the symmentry
kurtosis(Asia_dataset$`Gross Savings`)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is slightly lower than a normal distribution
plot(Asia_dataset$`Gross Savings`)
hist(Asia_dataset$`Gross Savings`)
# Describe industry variable for Asia data
mean(Asia_dataset$`Industry(%annual growth)`)
median(Asia_dataset$`Industry(%annual growth)`)
sd(Asia_dataset$`Industry(%annual growth)`)
var(Asia_dataset$`Industry(%annual growth)`)
skewness(Asia_dataset$`Industry(%annual growth)`)#slightly positively skewed to the right
kurtosis(Asia_dataset$`Industry(%annual growth)`)# distribution is highly leptokurtic since kurtosis is greater than 3, hence the peak of the distribution is more heavy tailed than a normal distribution
plot(Asia_dataset$`Industry(%annual growth)`)
hist(Asia_dataset$`Industry(%annual growth)`)
# Describe Internet variable for Asia data
mean(Asia_dataset$Internet)
median(Asia_dataset$Internet)
sd(Asia_dataset$Internet)
var(Asia_dataset$Internet)
skewness(Asia_dataset$Internet)#Negatively skewed to the left
kurtosis(Asia_dataset$Internet)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is lower than a normal distribution
plot(Asia_dataset$Internet)
hist(Asia_dataset$Internet)
# Describe Household Consumption  variable for Asia data
mean(Asia_dataset$`Household Spending`)
median(Asia_dataset$`Household Spending`)
sd(Asia_dataset$`Household Spending`)
var(Asia_dataset$`Household Spending`)
skewness(Asia_dataset$`Household Spending`)#Negatively skewed to the left
kurtosis(Asia_dataset$`Household Spending`)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is lower than a normal distribution
plot(Asia_dataset$`Household Spending`)
hist(Asia_dataset$`Household Spending`)
# Descriptive statistical analysis of Africa Data variables
summary(African_data)
# Describe FDI variable for African data
mean(African_data$FDI)
median(African_data$FDI)
sd(African_data$FDI)
var(African_data$FDI)
skewness(African_data$FDI)#Negatively skewed to the left
kurtosis(African_data$FDI)# distribution is leptokurtic since kurtosis is greater than 3, hence the peak of the distribution is higher than a normal distribution
plot(African_data$FDI)
hist(African_data$FDI)# not normally distributed
# Describe GDP variable for  data
mean(African_data$GDP)
median(African_data$GDP)
sd(African_data$GDP)
var(African_data$GDP)
skewness(African_data$GDP)# Slightly negetively  skewed to the left, its close to being symmentrical
kurtosis(African_data$GDP)#kurtosis of the distribution is slightly less than 3, hence the peak of the distribution is close to being normal
plot(African_data$GDP)
hist(African_data$GDP)
# Describe Gross Savings variable for Africa data
mean(African_data$`Gross Savings`)
median(African_data$`Gross Savings`)
sd(African_data$`Gross Savings`)
var(African_data$`Gross Savings`)
skewness(African_data$`Gross Savings`)#Slightly positively skewed to the right and close to the symmentry
kurtosis(African_data$`Gross Savings`)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is slightly lower than a normal distribution
plot(African_data$`Gross Savings`)
hist(African_data$`Gross Savings`)
# Describe industry variable for African data
mean(African_data$`Industry(%annual growth)`)
median(African_data$`Industry(%annual growth)`)
sd(African_data$`Industry(%annual growth)`)
var(African_data$`Industry(%annual growth)`)
skewness(African_data$`Industry(%annual growth)`)#slightly negatively skewed to the left and close to being normal
kurtosis(African_data$`Industry(%annual growth)`)# distribution is slightly leptokurtic since kurtosis is less than 3, hence the peak of the distribution is lower than a normal distribution
plot(African_data$`Industry(%annual growth)`)
hist(African_data$`Industry(%annual growth)`)
# Describe Internet variable for African data
mean(African_data$Internet)
median(African_data$Internet)
sd(African_data$Internet)
var(African_data$Internet)
skewness(African_data$Internet)#slightly positively skewed to the right
kurtosis(African_data$Internet)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is lower than a normal distribution
plot(African_data$Internet)
hist(African_data$Internet)
# Describe Population variable for African data
mean(African_data$`Household Spending`)
median(African_data$`Household Spending`)
sd(African_data$`Household Spending`)
var(African_data$`Household Spending`)
skewness(African_data$`Household Spending`)#Negatively skewed to the left
kurtosis(African_data$`Household Spending`)# distribution is Platykurtic since kurtosis is less than 3, hence the peak of the distribution is lower than a normal distribution
plot(African_data$`Household Spending`)
hist(African_data$`Household Spending`)
#-------------------------------Task 4.2----------------------------------------------
#Task Objective: Determine the degree of relationship that exists between chosen dependent variable which is GDP and other economic indicators as independent variable
# Correlation analysis for Asian Data
# Create a new dataframe for numeric data
Asia_num_Data= within(Asia_dataset,rm(Country, Year))
#View created dataframe
head(Asia_num_Data)
# run a correlation analysis on Asia numeric data with cor() function
round(cor(Asia_num_Data),digits = 2)
# View the Correlation plot
corrplot(cor(Asia_num_Data), method = "number", type = "upper")
# Correlation analysis for African Data
# Create a new dataframe for numeric data
African_num_Data= within(African_data,rm(Country, Year))
#View created dataframe
head(African_num_Data)
# run a correlation analysis on African numeric data with cor() function
round(cor(African_num_Data), digits = 2)
# View the Correlation plot
corrplot(cor(African_num_Data), method = "number",type = "upper")
#---------------------------------------------TASK 4.3--------------------------------------
#comparative analysis of the main hypothesis testing approaches
#Objective 1: compare the dependent variable (GDP) in Asia and Africa and determine if they are statistically significant
#Create a dataframe for GDP data in both Asia and Africa
Created_table= data.frame(Asia_dataset$GDP,African_data$GDP)
# view the created dataframe
Created_table
#visualize the distribution using boxplot
boxplot(Asia_dataset$GDP,African_data$GDP, names=c("Asia", "Africa"),xlab="Continent", ylab="GDP",main="GDP Annual % Growth in Asia and Africa")
#Test for Normality using Shapiro test
#Null hypothesis: the data are normally distributed - Alternative hypothesis: the data are not normally distributed
#set seed to make the dataset reproducable
set.seed(20)
shapiro.test(Asia_dataset$GDP)# p-value is 0.07 which is greater than 0.05 hence the GDP for Asia data is normally distributed, therefore we do not reject the Null hypothesis.
shapiro.test(African_data$GDP)# p-value is 0.98  which is greater than 0.05 hence the GDP for Africa data is normally distributed as well,therefore we do not reject the null hypothesis
#Conduct a Welch two sample t-test with p-value of 0.05 i.e 95% confidence level to check difference in GDP rate in Asia and Africa.
#Null Hypothesis is:𝐻0: GDP in Asia = GDP in Africa And our Alternative Hypothesis is:𝐻1:  GDP in Asia ≠ GDP  in Africa
t.test(Asia_dataset$GDP,African_data$GDP) # p-value is  0.0037 which is lower than 0.05, hence we reject the null hypothesis and accept the alternative hypothesis that validates that GDp in these two continents are different
#Objective 2: test whether the correlation (denoted by ρ) between GDP and it's predictors in Africa and Asia is significantly different from 0 or not in the population.
# Africa Correlation test
#Null hypothesis: There is no linear relationship between GDP and the indicator variables in Asia, ρ=0
#Alternative hypothesis:There is a linear relationship between GDP and the indicator variables in Africa, ρ≠0
# Correlation test using rcorr() function to show multiple variable
African_cor_test=rcorr(as.matrix(African_num_Data))
African_cor_test
#Asia Correlation test
#Null hypothesis: ρ=0(no linear relationship between GDP and  predicting variables in Asia)
#Alternative hypothesis: ρ≠0 ( a linear relationship exist between between GDP and  other variables in Asia)
Asia_cor_test=rcorr(as.matrix(Asia_num_Data))
Asia_cor_test # the correlation test shows a low p-value of 0.0015 for correlation between GDP and internet user
#---------------------------------Task 4.4--------------------------------------------------------------------
#Task Objective: Create a good predictive model for predicting GDP in Asia and Africa based on the value of one or more indicators using a linear regression model
##Fit a single linear model for Asian numeric data
# check for correlation again to select the best variable
cor(Asia_num_Data) # For Asia, industry percentage annual growth got the highest positive correlation to GDP
# view the correlation plot
corrplot(cor(African_num_Data))
# create a simple linear model with the selected predictor
Asia_Rmodel_1 <-lm(GDP ~ `Industry(%annual growth)`, Asia_num_Data)
# view the summary of the model
summary.lm(Asia_Rmodel_1)#R-squared value of 0.74 was generated by the model i.e the independent variable deescribes  74% variation of GDP
#plot the variable relationship using a scatter plot
plot(GDP ~ `Industry(%annual growth)`, Asia_num_Data,
col = "blue",
main = "Regression: GDP & Industry(%annual growth)",
xlab = " Industry(%annual growth)",
ylab = " GDP")
#fit a regression line to the simple linear model
abline(Asia_Rmodel_1, col= "red")
#check for residual independence
plot(Asia_Rmodel_1, 1)
#check for normality of the residuals
plot(Asia_Rmodel_1, 2)
#check for equal variances of the residuals
plot(Asia_Rmodel_1, 3)
#Fitting a Multiple linear regression  with more Independent variables
Asia_Rmodel_2 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings`, Asia_num_Data)
# view the summary of the model
summary.lm(Asia_Rmodel_2, 1)#R-squared value of 0.80 was generated by the model i.e the independent variables deescribes  80% variation of GDP
#Add another variable to the model and view the summary
Asia_Rmodel_3 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings` + `Household Spending`, Asia_num_Data)
summary.lm(Asia_Rmodel_3, 1)#R-squared value of 0.80 was generated by the model i.e the independent variable deescribes  % variation of GDP
#Add more variable to the model
Asia_Rmodel_4 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings` + `Household Spending` + Internet, Asia_num_Data) #R-squared 0.85
summary.lm(Asia_Rmodel_4, 1)
Asia_Rmodel_5 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings`  + Internet, Asia_num_Data)
summary.lm(Asia_Rmodel_5, 1)
#linearity assumption check for model 5
pairs(Asia_num_Data[,c(2,5,6,7)], lower.panel = NULL, pch = 19,cex = 0.2)
#Check for Residuals’ Independence
plot(Asia_Rmodel_5, 1)# Residual vs fitted plot shows no pattern of correlaton, assumption of Residual independence achieved
#Normality of residuals
plot(Asia_Rmodel_5, 2) # Plot shows Normality of residuals as most of the residaul points are close to the line
# check for Equal variances of the residuals (Homoscedasticity)
plot(Asia_Rmodel_5, 3) # plot shows homoscedacity as residuals are randomly scattered around the red line with equal variance, assumption of homoscedacity is achieved.
# Check for No multicollinearity
vif(Asia_Rmodel_5) # Vif values where less than 5 hence the moderate correlation exists between predictors but not on a level that requires attention( if vid is more than 5)
#Fit a simple linear model for African numeric data
# check for correlation again to select predictors
cor(African_num_Data) #industry(%annual growth) also had the highest value for Africa data
# view the correlation plot
corrplot(cor(African_num_Data))
# fit a simple model with the selected predictor
African_model_1 <-lm(GDP ~ `Industry(%annual growth)`, African_num_Data)
# view the summary of the model
summary.lm(African_model_1)## low R-squared value of 0.43 was generated by the model, hence the indicator variable is describing just 43% variation in GDP
#plot the variable relationship to visualiz
plot(GDP ~ `Industry(%annual growth)`, African_num_Data,
col = "blue",
main = "Regression: GDP & Industry(%annual growth)",
xlab = " Industry(%annual growth)",
ylab = " GDP")
#
#fit a regression line to the simple linear model
abline(African_model_1, col= "red")
#check for residual independence
plot(African_model_1, 1)
#check for normality of the residuals
plot(African_model_1, 2)
#check for equal variances of the residuals
plot(African_model_1, 3)
#Fitting a Multiple linear regression  with more Independent variables data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAWElEQVR42mNgGPTAxsZmJsVqQApgmGw1yApwKcQiT7phRBuCzzCSDSHGMKINIeDNmWQlA2IigKJwIssQkHdINgxfmBBtGDEBS3KCxBc7pMQgMYE5c/AXPwAwSX4lV3pTWwAAAABJRU5ErkJggg==
African_model_2 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings`, African_num_Data)
# view the summary of the model
summary.lm(African_model_2, 1)#R-squared value of 0.44 was generated by the model i.e the independent variables deescribes  80% variation of GDP
#Add another variable to the model and view the summary
African_model_3 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings` + `Household Spending`, African_num_Data)
summary.lm(African_model_3, 1)#R-squared value of 0.46 was generated by the model i.e the independent variable deescribes  % variation of GDP
#Add more variable to the model
African_model_4 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings` + `Household Spending` + Internet, African_num_Data) #R-squared 0.50
summary.lm(African_model_4, 1)
African_model_5 <-lm(GDP ~ `Industry(%annual growth)` + `Gross Savings`  + Internet, African_num_Data)
summary.lm(African_model_5, 1)#R-squared value of 0.49
African_model_6 <-lm(GDP ~ `Industry(%annual growth)` + Internet, African_num_Data)
summary.lm(African_model_6, 1) # R-squared value of 0.48
#linearity assumption check for model 6
pairs(African_num_Data[,c(2,6,7)], lower.panel = NULL, pch = 19,cex = 0.2)
#Check for Residuals’ Independence
plot(African_model_6, 1)# Residual vs fitted plot shows no pattern of correlaton, assumption of Residual independence achieved
#Normality of residuals
plot(African_model_6, 2) # Plot shows Normality of residuals as most of the residaul points are close to the line
# check for Equal variances of the residuals (Homoscedasticity)
plot(African_model_6, 3) # plot shows homoscedacity as residuals are randomly scattered around the red line with equal variance, assumption of homoscedacity is achieved.
#-------------------------------Task 4.5----------------------------------------------
# Time series analysis for GDP growth rate in Nigeria referencing https://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html
#Task objective: Create a good forecasting time series model to forecast Nigeria GDP in 10 years
# Read a file containing GDP record for NIgeria from 2000 to 2019(total of 20 years)
NG_GDP= read.csv('Nigeria GDP data.csv')
NG_GDP
# create a time series function for the Nigeria_gdp data in created table
NG_GDP_Time_series <- ts(NG_GDP,frequency=1, start=c(2000))
NG_GDP_Time_series
# plot the created time series
plot.ts(NG_GDP_Time_series)
#Smooth and Forecast using HoltWinters Simple Exponential smoothing method with Trend for short term forecast
NG_GDP_timeseriesSMA <- SMA(NG_GDP_Time_series,n=3)
plot(NG_GDP_timeseriesSMA)
predict_GDPSeries = HoltWinters(NG_GDP_Time_series, gamma=FALSE)
predict_GDPSeries
# Plot the predicted model
plot(predict_GDPSeries)
# view  output of the HoltWinters() function stored as a list in element fitted
predict_GDPSeries$fitted
# view the sum of square errors for the in-sample forecast errors
predict_GDPSeries$SSE
# predict future GDP values for next 10 years using forecast function
predictfuture_GDP= forecast(predict_GDPSeries, h=10)
#View the future prediction model
predictfuture_GDP
# plot the future prediction model
plot(predictfuture_GDP)
#check for the forcast error which is stored in the residuals
predictfuture_GDP$residuals
# plot auto correlation function (ACF) for the future predictions to obtain a correlogram of the in-sample forecast errors for lags 1-10
acf(predictfuture_GDP$residuals, lag.max=10 , na.action = na.pass)
# plot a partial auto correlation function (PACF) for the future predictions to obtain a direct correlogram of the in-sample forecast errors for lags 1-10
pacf(predictfuture_GDP$residuals, lag.max=10 , na.action = na.pass)
# Do a Ljung-Box test to test whether there are non-zero auto correlations at lags 1-10
Box.test(predictfuture_GDP$residuals, lag=10, type="Ljung-Box")# the p-value is 0.984, indicating that there is little evidence of non-zero autocorrelations in the in-sample forecast errors at lags 1-10.
# Check for constant Variance of forecast errors/residuals
plot.ts(predictfuture_GDP$residuals) # plot shows variance is not constant
# Check for normal distribution of forecast errors around mean zero
#create a function that plots a histogram of the forecast errors
plotForecastErrors <- function(forecasterrors)
{
# make a histogram of the forecast errors:
mybinsize <- IQR(forecasterrors)/4
mysd   <- sd(forecasterrors)
mymin  <- min(forecasterrors) - mysd*5
mymax  <- max(forecasterrors) + mysd*3
# generate normally distributed data with mean 0 and standard deviation mysd
mynorm <- rnorm(10000, mean=0, sd=mysd)
mymin2 <- min(mynorm)
mymax2 <- max(mynorm)
if (mymin2 < mymin) { mymin <- mymin2 }
if (mymax2 > mymax) { mymax <- mymax2 }
# make a red histogram of the forecast errors, with the normally distributed data overlaid:
mybins <- seq(mymin, mymax, mybinsize)
hist(forecasterrors, col="red", freq=FALSE, breaks=mybins)
# freq=FALSE ensures the area under the histogram = 1
# generate normally distributed data with mean 0 and standard deviation mysd
myhist <- hist(mynorm, plot=FALSE, breaks=mybins)
# plot the normal curve as a blue line on top of the histogram of forecast errors:
points(myhist$mids, myhist$density, type="l", col="blue", lwd=2)
}
# Remove Null values from forecast residuals before applying the function created
predictfuture_GDP$residuals <-predictfuture_GDP$residuals[!is.na(predictfuture_GDP$residuals)]
# Plot a histogram that shows distribution of forecast residuals with the created function
plotForecastErrors(predictfuture_GDP$residuals)
# check if time series is stationary for further improvement of model
plot.ts(NG_GDP_Time_series) # time series is non-stationary
